[supervisord]

[program:nginx]
process_name=%(program_name)s_%(process_num)d
numprocs=1
startsecs=0
startretries=5
autostart=true
command=/usr/sbin/nginx -c {{ _tmp_fs.path('nginx.conf') }}
autorestart=true
stderr_logfile={{ _tmp_fs.path() }}%(program_name)s_stderr.log
stderr_logfile_maxbytes=10MB
stdout_logfile={{ _tmp_fs.path() }}%(program_name)s_stdout.log
stdout_logfile_maxbytes=10MB

[program:appyter]
process_name=%(program_name)s_%(process_num)d
numprocs=1
numprocs_start=1
autostart=true
autorestart=true
environment={% for k, v in _config.items() %}{{ k }}={{ str(v)|jsonify }}{% if not loop.last %},{% endif %}{% endfor %}
command={{ sys.executable }} -u -m appyter --socket={{ _tmp_fs.path() }}%(program_name)s_%(process_num)d.sock
stderr_logfile={{ _tmp_fs.path() }}%(program_name)s_stderr.log
stderr_logfile_maxbytes=10MB
stdout_logfile={{ _tmp_fs.path() }}%(program_name)s_stdout.log
stdout_logfile_maxbytes=10MB
